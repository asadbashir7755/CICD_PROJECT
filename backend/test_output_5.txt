ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please use "isolatedModules: true" in /home/asadbashir/asad/DevOpS-Practice/ci-cd/gravity_project/wanderlust/backend/tsconfig.json instead, see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
(node:43953) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL tests/unit/controllers/posts-controller.test.ts
  createPostHandler
    ✕ Post creation: Success - All fields are valid (6 ms)
    ✕ Post creation: Failure - Invalid image url (6 ms)
    ✕ Post creation: Failure - Some fields are missing (3 ms)
    ✕ Post creation: Failure - Too Many Categories (2 ms)
    ✕ Post creation: Failure - Internal server error (8 ms)
  getAllPostsHandler
    ✕ Get all posts: Success - Retrieving all posts list (1 ms)
    ✕ Get all posts: Failure - Internal Server Error
  getFeaturedPostsHandler
    ✕ Get featured posts: Success - Retrieving all featured posts list (1 ms)
    ✕ Get featured posts: Failure - Internal Server Error
  getPostByCategoryHandler
    ✕ Get posts by category: Success - Retrieving posts list of specified category
    ✓ Get posts by category: Failure - Invalid category (1 ms)
    ✕ Get posts by category: Failure - Internal Server Error
  getLatestPostsHandler
    ✕ Get latest posts: Success - Retrieving most recent posts list
    ✕ Get latest posts: Failure - Internal Server Error (1 ms)
  getPostByIdHandler
    ✕ Get post by ID: Success - Retrieving Specific Post
    ✕ Get post by ID: Failure - Post not found (Specified post ID is invalid) (7 ms)
    ✕ Get post by ID: Failure - Internal Server Error
  updatePostHandler
    ✕ Update post: Success - Modifying post content
    ✕ Update post: Failure - Post not found (Specified post ID is invalid)
    ✕ Update post: Failure - Internal Server Error
  deletePostByIdHandler
    ✕ Delete Post: Success - Removing Post with specified ID
    ✕ Delete Post: Failure - Post not found (Specified post ID is invalid) (1 ms)
    ✕ Delete Post: Failure - Internal Server Error (1 ms)

  ● createPostHandler › Post creation: Success - All fields are valid

    expect(received).toHaveBeenCalledTimes(expected)

    Matcher error: received value must be a mock or spy function

    Received has type:  function
    Received has value: [Function model]

      36 |     await createPostHandler(req, res);
      37 |
    > 38 |     expect(Post).toHaveBeenCalledTimes(1);
         |                  ^
      39 |     expect(Post).toHaveBeenCalledWith(postObject);
      40 |     expect(res.status).toHaveBeenCalledWith(HTTP_STATUS.OK);
      41 |     expect(res.json).toHaveBeenCalledWith(postObject);

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:38:18)

  ● createPostHandler › Post creation: Failure - Invalid image url

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 400
    Received
           1: 500
           2: 500

    Number of calls: 2

      50 |     await createPostHandler(req, res);
      51 |
    > 52 |     expect(res.status).toHaveBeenCalledWith(HTTP_STATUS.BAD_REQUEST);
         |                        ^
      53 |     expect(res.json).toHaveBeenCalledWith({
      54 |       message: RESPONSE_MESSAGES.POSTS.INVALID_IMAGE_URL,
      55 |     });

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:52:24)

  ● createPostHandler › Post creation: Failure - Some fields are missing

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 400
    Received
           1: 500
           2: 500
           3: 500

    Number of calls: 3

      65 |     await createPostHandler(req, res);
      66 |
    > 67 |     expect(res.status).toHaveBeenCalledWith(HTTP_STATUS.BAD_REQUEST);
         |                        ^
      68 |     expect(res.json).toHaveBeenCalledWith({ message: RESPONSE_MESSAGES.COMMON.REQUIRED_FIELDS });
      69 |   });
      70 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:67:24)

  ● createPostHandler › Post creation: Failure - Too Many Categories

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 400
    Received
           1: 500
           2: 500
           3: 500

    Number of calls: 4

      77 |     await createPostHandler(req, res);
      78 |
    > 79 |     expect(res.status).toHaveBeenCalledWith(HTTP_STATUS.BAD_REQUEST);
         |                        ^
      80 |     expect(res.json).toHaveBeenCalledWith({
      81 |       message: RESPONSE_MESSAGES.POSTS.MAX_CATEGORIES,
      82 |     });

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:79:24)

  ● createPostHandler › Post creation: Failure - Internal server error

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"message": "Internal Server Error"}
    Received
           1
              Object {
            -   "message": "Internal Server Error",
            +   "message": [TypeError: Cannot read properties of undefined (reading '_id')],
              },
           2
              Object {
            -   "message": "Internal Server Error",
            +   "message": [TypeError: Cannot read properties of undefined (reading '_id')],
              },
           3
              Object {
            -   "message": "Internal Server Error",
            +   "message": [TypeError: Cannot read properties of undefined (reading '_id')],
              },

    Number of calls: 5

      92 |
      93 |     expect(res.status).toHaveBeenCalledWith(HTTP_STATUS.INTERNAL_SERVER_ERROR);
    > 94 |     expect(res.json).toHaveBeenCalledWith({
         |                      ^
      95 |       message: RESPONSE_MESSAGES.COMMON.INTERNAL_SERVER_ERROR,
      96 |     });
      97 |   });

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:94:22)

  ● getAllPostsHandler › Get all posts: Success - Retrieving all posts list

    TypeError: Post.find.mockResolvedValue is not a function

      108 |     ];
      109 |
    > 110 |     (Post as any).find.mockResolvedValue(mockPosts);
          |                        ^
      111 |
      112 |     await getAllPostsHandler(req, res);
      113 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:110:24)

  ● getAllPostsHandler › Get all posts: Failure - Internal Server Error

    TypeError: Post.find.mockRejectedValueOnce is not a function

      118 |   it('Get all posts: Failure - Internal Server Error', async () => {
      119 |     const req: any = createRequestObject();
    > 120 |     (Post as any).find.mockRejectedValueOnce(new Error(RESPONSE_MESSAGES.COMMON.INTERNAL_SERVER_ERROR));
          |                        ^
      121 |     await getAllPostsHandler(req, res);
      122 |
      123 |     expect(res.status).toHaveBeenCalledWith(HTTP_STATUS.INTERNAL_SERVER_ERROR);

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:120:24)

  ● getFeaturedPostsHandler › Get featured posts: Success - Retrieving all featured posts list

    TypeError: Post.find.mockResolvedValue is not a function

      138 |     ];
      139 |
    > 140 |     (Post as any).find.mockResolvedValue(mockFeaturedPosts);
          |                        ^
      141 |
      142 |     await getFeaturedPostsHandler(req, res);
      143 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:140:24)

  ● getFeaturedPostsHandler › Get featured posts: Failure - Internal Server Error

    TypeError: Post.find.mockRejectedValueOnce is not a function

      148 |   it('Get featured posts: Failure - Internal Server Error', async () => {
      149 |     const req: any = createRequestObject();
    > 150 |     (Post as any).find.mockRejectedValueOnce(new Error(RESPONSE_MESSAGES.COMMON.INTERNAL_SERVER_ERROR));
          |                        ^
      151 |     await getFeaturedPostsHandler(req, res);
      152 |
      153 |     expect(res.status).toHaveBeenCalledWith(HTTP_STATUS.INTERNAL_SERVER_ERROR);

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:150:24)

  ● getPostByCategoryHandler › Get posts by category: Success - Retrieving posts list of specified category

    TypeError: Post.find.mockResolvedValue is not a function

      168 |     ];
      169 |
    > 170 |     (Post as any).find.mockResolvedValue(mockPosts);
          |                        ^
      171 |
      172 |     await getPostByCategoryHandler(req, res);
      173 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:170:24)

  ● getPostByCategoryHandler › Get posts by category: Failure - Internal Server Error

    TypeError: Post.find.mockRejectedValueOnce is not a function

      188 |     const req: any = createRequestObject({ params: { category: validCategories[1] } });
      189 |
    > 190 |     (Post as any).find.mockRejectedValueOnce(new Error(RESPONSE_MESSAGES.COMMON.INTERNAL_SERVER_ERROR));
          |                        ^
      191 |
      192 |     await getPostByCategoryHandler(req, res);
      193 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:190:24)

  ● getLatestPostsHandler › Get latest posts: Success - Retrieving most recent posts list

    TypeError: Post.find.mockResolvedValueOnce is not a function

      209 |     ];
      210 |
    > 211 |     (Post as any).find.mockResolvedValueOnce(mockPosts);
          |                        ^
      212 |
      213 |     await getLatestPostsHandler(req, res);
      214 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:211:24)

  ● getLatestPostsHandler › Get latest posts: Failure - Internal Server Error

    TypeError: Post.find.mockRejectedValueOnce is not a function

      220 |     const req: any = createRequestObject();
      221 |
    > 222 |     (Post as any).find.mockRejectedValueOnce(new Error(RESPONSE_MESSAGES.COMMON.INTERNAL_SERVER_ERROR));
          |                        ^
      223 |
      224 |     await getLatestPostsHandler(req, res);
      225 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:222:24)

  ● getPostByIdHandler › Get post by ID: Success - Retrieving Specific Post

    TypeError: Post.findById.mockResolvedValueOnce is not a function

      237 |     const mockPost: any = createPostObject({ _id: '6910293383' });
      238 |
    > 239 |     (Post as any).findById.mockResolvedValueOnce(mockPost);
          |                            ^
      240 |
      241 |     await getPostByIdHandler(req, res);
      242 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:239:28)

  ● getPostByIdHandler › Get post by ID: Failure - Post not found (Specified post ID is invalid)

    TypeError: Post.findById.mockResolvedValue is not a function

      248 |     const req: any = createRequestObject({ params: { id: '6910293383' } });
      249 |
    > 250 |     (Post as any).findById.mockResolvedValue(null);
          |                            ^
      251 |
      252 |     await getPostByIdHandler(req, res);
      253 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:250:28)

  ● getPostByIdHandler › Get post by ID: Failure - Internal Server Error

    TypeError: Post.findById.mockRejectedValueOnce is not a function

      259 |     const req: any = createRequestObject({ params: { id: '6910293383' } });
      260 |
    > 261 |     (Post as any).findById.mockRejectedValueOnce(new Error(RESPONSE_MESSAGES.COMMON.INTERNAL_SERVER_ERROR));
          |                            ^
      262 |
      263 |     await getPostByIdHandler(req, res);
      264 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:261:28)

  ● updatePostHandler › Update post: Success - Modifying post content

    TypeError: Post.findByIdAndUpdate.mockResolvedValueOnce is not a function

      280 |
      281 |     // Mock the behavior of Post.findByIdAndUpdate
    > 282 |     (Post as any).findByIdAndUpdate.mockResolvedValueOnce(mockPost);
          |                                     ^
      283 |
      284 |     await updatePostHandler(req, res);
      285 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:282:37)

  ● updatePostHandler › Update post: Failure - Post not found (Specified post ID is invalid)

    TypeError: Post.findByIdAndUpdate.mockResolvedValueOnce is not a function

      295 |
      296 |     // Mock the behavior of Post.findByIdAndUpdate
    > 297 |     (Post as any).findByIdAndUpdate.mockResolvedValueOnce(null);
          |                                     ^
      298 |
      299 |     await updatePostHandler(req, res);
      300 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:297:37)

  ● updatePostHandler › Update post: Failure - Internal Server Error

    TypeError: Post.findByIdAndUpdate.mockRejectedValueOnce is not a function

      309 |     });
      310 |     // Mock the behavior of Post.findByIdAndUpdate
    > 311 |     (Post as any).findByIdAndUpdate.mockRejectedValueOnce(new Error(RESPONSE_MESSAGES.COMMON.INTERNAL_SERVER_ERROR));
          |                                     ^
      312 |     await updatePostHandler(req, res);
      313 |
      314 |     expect(res.status).toHaveBeenCalledWith(HTTP_STATUS.INTERNAL_SERVER_ERROR);

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:311:37)

  ● deletePostByIdHandler › Delete Post: Success - Removing Post with specified ID

    TypeError: Post.findByIdAndDelete.mockResolvedValueOnce is not a function

      326 |
      327 |     // Mock the behavior of Post.findByIdAndRemove
    > 328 |     (Post as any).findByIdAndDelete.mockResolvedValueOnce(mockPost);
          |                                     ^
      329 |
      330 |     await deletePostByIdHandler(req, res);
      331 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:328:37)

  ● deletePostByIdHandler › Delete Post: Failure - Post not found (Specified post ID is invalid)

    TypeError: Post.findByIdAndDelete.mockRejectedValueOnce is not a function

      341 |     // Mock the behavior of Post.findByIdAndRemove
      342 |
    > 343 |     (Post as any).findByIdAndDelete.mockRejectedValueOnce(new Error(RESPONSE_MESSAGES.COMMON.INTERNAL_SERVER_ERROR));
          |                                     ^
      344 |
      345 |     await deletePostByIdHandler(req, res);
      346 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:343:37)

  ● deletePostByIdHandler › Delete Post: Failure - Internal Server Error

    TypeError: Post.findByIdAndDelete.mockRejectedValueOnce is not a function

      353 |
      354 |     // Mock the behavior of Post.findByIdAndRemove
    > 355 |     (Post as any).findByIdAndDelete.mockRejectedValueOnce(new Error(RESPONSE_MESSAGES.COMMON.INTERNAL_SERVER_ERROR));
          |                                     ^
      356 |
      357 |     await deletePostByIdHandler(req, res);
      358 |

      at Object.<anonymous> (tests/unit/controllers/posts-controller.test.ts:355:37)

Test Suites: 1 failed, 1 total
Tests:       22 failed, 1 passed, 23 total
Snapshots:   0 total
Time:        1.818 s
Ran all test suites matching /tests\/unit\/controllers\/posts-controller.test.ts/i.
